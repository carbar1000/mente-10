<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obrigado!</title>
    <link rel="stylesheet" href="./webform-mente.css">
    <script type="text/javascript">
        async function enviarParaSupabase() {
            const SUPABASE_URL = process.env.SUPABASE_URL;
            const SUPABASE_ANON_KEY = process.env.SUPABASE_ANON_KEY;
            const { createClient } = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm');

            const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

            // Recupera os dados do formulário do localStorage
            const formData = JSON.parse(localStorage.getItem('formData'));

            const { data, error } = await supabase
                .from('respostas')
                .insert([formData]);


            if (error) {
                console.error('Erro ao enviar dados:', error);
            } else {
                console.log('Dados enviados com sucesso:', data);
            }
        }

        // Verifica se há dados no localStorage antes de enviar
        document.addEventListener('DOMContentLoaded', () => {
            const formData = localStorage.getItem('formData');
            if (formData) {
                enviarParaSupabase();
                // Limpa os dados após o envio
                localStorage.removeItem('formData');
            } else {
                console.error('Nenhum dado do formulário encontrado');
            }
        });

    </script>
</head>
<body>
    <div class="centered-text">
        <h1>Obrigado por enviar suas respostas que você irá fornecer!</h1>
        <p>Suas informações serão recebidas com sucesso.</p>

    </div>
</body>
</html>
